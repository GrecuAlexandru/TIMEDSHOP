<html lang="en">
    <head>
        <link rel="icon" href="resources/icons/favicon.png" />
        <link rel="stylesheet" href="styles/launchPage.css" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="UTF-8" />
        <title>Timed Shop</title>
        <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
        <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
        <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    </head>
    <body>
        <div class="splash">
            <img
                class="fade-in"
                src="resources/icons/TimedLogoClock.svg"
                alt="TIMED"
            />
        </div>

        <div id="TimedShopMainLogo">
            <img src="resources/icons/TimedShopMainLogo.svg" alt="TIMED SHOP" />
        </div>
        <nav class="navMenu" id="navMenu">
            <a href="Sale.html">SALE</a>
            <a href="Women.html?sortBy=newArrival&type=" id="women">WOMEN</a>
            <a href="Men.html">MEN</a>
            <a href="Accessories.html">ACCESSORIES</a>
            <a href="account.html" id="account">
                <img
                    alt="ACCOUNT"
                    src="/resources/icons/User.svg"
                    onmouseover="this.src='resources/icons/UserPurple.svg'"
                    onmouseout="this.src='resources/icons/User.svg'"
                />
            </a>
            <a href="favorites.html" id="favorites">
                <img
                    class="icon-badge-icon-favorites"
                    id="favoritesIMG"
                    alt="FAVORITES"
                    src="/resources/icons/favorites.svg"
                    onmouseover="this.src='resources/icons/favoritesPurple.svg'"
                    onmouseout="this.src='resources/icons/favorites.svg'"
                />
                <div id="favoritesCount" class="icon-badge-favorites">6</div>
            </a>
            <a href="LogIn.html" id="LogIn">LOG IN</a>
            <a href="Register.html" id="register">REGISTER</a>
            <a href="Cart.html" id="cart" class="icon-badge-container">
                <img
                    class="icon-badge-icon"
                    alt="CART"
                    src="/resources/icons/Cart.svg"
                    onmouseover="this.src='resources/icons/CartPurple.svg'"
                    onmouseout="this.src='resources/icons/Cart.svg'"
                />
                <div id="cartCount" class="icon-badge">6</div>
            </a>
            <div class="dot" id="dott"></div>
        </nav>
        <div id="leftBubble"></div>
        <div id="rightBubble"></div>
        <img src="resources/icons/hoodieModel.png" id="mainModel" />
        <div id="leftMainDiv">
            <div id="saleDiv">
                <a id="saleTextLeft"
                    >ON SALE&nbsp;&nbsp;&nbsp;&nbsp;â€¢&nbsp;&nbsp;&nbsp;&nbsp;40%
                    OFF</a
                >
            </div>
            <div id="mainProductName">
                <a class="mainProductNameText">BLACK</a>
                <a class="mainProductNameText">HOODIE</a>
            </div>
            <div id="buttonDiv">
                <a href="Sale.html"
                    ><img
                        src="resources/icons/mainScreenArrowButton.svg"
                        alt=""
                        id="mainScreenArrowButton"
                /></a>
                <a id="shopNowText" href="Sale.html">SHOP NOW</a>
            </div>
        </div>
        <script>
             // Initialize Firebase
            // TODO: Replace with your project's customized code snippet
            var config = {
                apiKey: "AIzaSyCkBvDNzSvorpEdz2twDAVI09x-FaVsDGg",
                authDomain: "timedshop-a5a66.firebaseapp.com",
                projectId: "timedshop-a5a66",
                storageBucket: "timedshop-a5a66.appspot.com",
                messagingSenderId: "172835576987",
                appId: "1:172835576987:web:2e588ca7a77cc008affa3e",
                measurementId: "G-3VCHXLRX5K",
            };
            firebase.initializeApp(config);
            const db = firebase.firestore();
            let cartCount = document.getElementById("cartCount");
            let favoritesCount = document.getElementById("favoritesCount");
            firebase.auth().onAuthStateChanged((user) => {
                if (user) {
                    var uid = user.uid;
                    console.log("logged in user: ", user.email);
                    document.getElementById("LogIn").style.display = "none";
                    document.getElementById("register").style.display = "none";
                    document.getElementById("account").style.display = "flex";
                    document.getElementById("favorites").style.display = "block";
                    db.collection("users")
                        .doc(uid)
                        .get()
                        .then((data) => {
                            if(data.data().cart)
                            {
                                cartCount.innerText = data.data().cart.length;
                            }
                            else
                            {
                                cartCount.innerText = 0;
                            }

                            if(data.data().favorites)
                            {
                                favoritesCount.innerText = data.data().favorites.length;
                            }
                            else
                            {
                                favoritesCount.innerText = 0;
                            }
                        })
                } else {
                    // User is signed out
                    console.log("sign out");
                    document.getElementById("account").style.display = "none";
                    document.getElementById("favorites").style.display = "none";
                    document.getElementById("LogIn").style.display = "flex";
                    document.getElementById("register").style.display = "flex";
                }
            });
        </script>
        <script src="splashscreen.js"></script>
    </body>
</html>
